document.addEventListener('DOMContentLoaded', () => {

	const wordsJson = localStorage.getItem('gameWordsJson');
	const answersList = document.getElementById('player-answers');

	// ★ ユーザー名を生成するためのカウンターを初期化 ★
	let playerCounter = 1;

	if (wordsJson && answersList) {
		try {
			// ★ 修正点: JSON文字列をJavaScriptの配列に変換 ★
			// 例: ["回答1", "回答2"]
			const wordsArray = JSON.parse(wordsJson);

			if (!Array.isArray(wordsArray)) {
				console.error("解析されたデータが回答の配列ではありません。", wordsArray);
				return;
			}

			console.group("✅ GO画面: 回答結果の表示");
			console.log("回答リスト (JS Array):", wordsArray);
			console.groupEnd();

			let htmlContent = '';

			// ★ 修正点: 配列を for...of でループ処理する ★
			for (const answer of wordsArray) {

				// ユーザー名を順番に User1, User2 に固定
				const playerName = `User${playerCounter}`;
				playerCounter++;

				// HTMLテンプレートに合わせて<li>要素を作成
				htmlContent += `
			                    <li class="answer-item">
			                        <span class="player-name">${playerName}</span>: 
			                        <span class="player-answer-different">${answer}</span>
			                    </li>
			                `;
			}

			// 既存のリスト内容を新しい回答で置き換える
			answersList.innerHTML = htmlContent;

			// データが二重で使われないようストレージから削除
			localStorage.removeItem('gameWordsJson');

		} catch (e) {
			console.error("Local Storageデータの解析に失敗しました:", e);
			answersList.innerHTML = '<li>データの読み込みに失敗しました。</li>';
		}
	} else {
		console.warn("Local Storageにゲーム結果データが見つからないか、リスト要素が見つかりませんでした。");
		if (answersList) {
			answersList.innerHTML = '<li>回答データがありません。</li>';
		}
	}

});